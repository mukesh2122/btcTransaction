"use strict";

var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports["default"] = void 0;

var _bignumber = _interopRequireDefault(require("bignumber.js"));

var gasOveruseNum = 11;
var gasOveruseDenom = 10;

var _default = function _default(gasUsed, gasLimit) {
  var gasUsedBN = new _bignumber["default"](gasUsed);
  var gasLimitBN = new _bignumber["default"](gasLimit);

  if (gasUsedBN.isZero()) {
    return gasLimitBN;
  } // over = gasLimit/gasUsed - 1 - 0.1
  // over = min(over, 1)
  // gasToBurn = (gasLimit - gasUsed) * over
  // so to factor out division from `over`
  // over*gasUsed = min(gasLimit - (11*gasUsed)/10, gasUsed)
  // gasToBurn = ((gasLimit - gasUsed)*over*gasUsed) / gasUsed


  var overuse = gasUsedBN.times(gasOveruseNum).dividedToIntegerBy(gasOveruseDenom);
  var over = gasLimit.minus(overuse);

  if (over.isLessThan(0)) {
    return new _bignumber["default"](0);
  }

  if (over.isGreaterThan(gasUsedBN)) {
    over = gasUsedBN;
  }

  var gasToBurn = gasLimit.minus(gasUsedBN);
  gasToBurn = gasToBurn.times(over);
  gasToBurn = gasToBurn.dividedToIntegerBy(gasUsedBN);
  return new _bignumber["default"](gasToBurn.toFixed(0, 4));
};

exports["default"] = _default;
//# sourceMappingURL=computeGasToBurn.js.map