{"version":3,"sources":["../../src/utils/computeGasToBurn.ts"],"names":["BigNumber","gasOveruseNum","gasOveruseDenom","gasUsed","gasLimit","gasUsedBN","gasLimitBN","isZero","overuse","times","dividedToIntegerBy","over","minus","isLessThan","isGreaterThan","gasToBurn","toFixed"],"mappings":"AAAA,OAAOA,SAAP,MAAsB,cAAtB;AAEA,IAAMC,aAAa,GAAG,EAAtB;AACA,IAAMC,eAAe,GAAG,EAAxB;AAEA,gBAAe,UAACC,OAAD,EAAqBC,QAArB,EAAwD;AACrE,MAAMC,SAAS,GAAG,IAAIL,SAAJ,CAAcG,OAAd,CAAlB;AACA,MAAMG,UAAU,GAAG,IAAIN,SAAJ,CAAcI,QAAd,CAAnB;;AACA,MAAIC,SAAS,CAACE,MAAV,EAAJ,EAAwB;AACtB,WAAOD,UAAP;AACD,GALoE,CAOrE;AACA;AACA;AAEA;AACA;AACA;;;AACA,MAAME,OAAO,GAAGH,SAAS,CACtBI,KADa,CACPR,aADO,EAEbS,kBAFa,CAEMR,eAFN,CAAhB;AAGA,MAAIS,IAAI,GAAGP,QAAQ,CAACQ,KAAT,CAAeJ,OAAf,CAAX;;AAEA,MAAIG,IAAI,CAACE,UAAL,CAAgB,CAAhB,CAAJ,EAAwB;AACtB,WAAO,IAAIb,SAAJ,CAAc,CAAd,CAAP;AACD;;AAED,MAAIW,IAAI,CAACG,aAAL,CAAmBT,SAAnB,CAAJ,EAAmC;AACjCM,IAAAA,IAAI,GAAGN,SAAP;AACD;;AAED,MAAIU,SAAS,GAAGX,QAAQ,CAACQ,KAAT,CAAeP,SAAf,CAAhB;AACAU,EAAAA,SAAS,GAAGA,SAAS,CAACN,KAAV,CAAgBE,IAAhB,CAAZ;AACAI,EAAAA,SAAS,GAAGA,SAAS,CAACL,kBAAV,CAA6BL,SAA7B,CAAZ;AAEA,SAAO,IAAIL,SAAJ,CAAce,SAAS,CAACC,OAAV,CAAkB,CAAlB,EAAqB,CAArB,CAAd,CAAP;AACD,CAhCD","sourcesContent":["import BigNumber from 'bignumber.js'\n\nconst gasOveruseNum = 11\nconst gasOveruseDenom = 10\n\nexport default (gasUsed: BigNumber, gasLimit: BigNumber): BigNumber => {\n  const gasUsedBN = new BigNumber(gasUsed)\n  const gasLimitBN = new BigNumber(gasLimit)\n  if (gasUsedBN.isZero()) {\n    return gasLimitBN\n  }\n\n  // over = gasLimit/gasUsed - 1 - 0.1\n  // over = min(over, 1)\n  // gasToBurn = (gasLimit - gasUsed) * over\n\n  // so to factor out division from `over`\n  // over*gasUsed = min(gasLimit - (11*gasUsed)/10, gasUsed)\n  // gasToBurn = ((gasLimit - gasUsed)*over*gasUsed) / gasUsed\n  const overuse = gasUsedBN\n    .times(gasOveruseNum)\n    .dividedToIntegerBy(gasOveruseDenom)\n  let over = gasLimit.minus(overuse)\n\n  if (over.isLessThan(0)) {\n    return new BigNumber(0)\n  }\n\n  if (over.isGreaterThan(gasUsedBN)) {\n    over = gasUsedBN\n  }\n\n  let gasToBurn = gasLimit.minus(gasUsedBN)\n  gasToBurn = gasToBurn.times(over)\n  gasToBurn = gasToBurn.dividedToIntegerBy(gasUsedBN)\n\n  return new BigNumber(gasToBurn.toFixed(0, 4))\n}\n"],"file":"computeGasToBurn.js"}